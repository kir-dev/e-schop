<script>
	document.addEventListener("turbolinks:load",function(){
	input = $("#q")
	users=null
		
	
	var options = {
		getValue: "name",
		url: function(phrase){
			$.getJSON('/conversations/search.json?q='+phrase, function(data) {
			users=data	
			});
		
		return "/conversations/search.json?q=" + phrase
		},
		categories: [
		{   
			listLocation: "users",
			header: "<strong>Felhasználók<strong>",
		}
		],
		list: {
		onChooseEvent: function() {
				var index=input.getSelectedItemIndex()
				$("#selected_user_id").val(users.users[index].id)

				
				document.forms["search_form"].submit();
			}
		}
	}
	input.easyAutocomplete(options)
	});
</script>

<div class="uk-card uk-padding-small uk-card-default uk-padding-remove-top uk-padding-remove-bottom" uk-sticky="offset: 80; bottom: #top" style="z-index: 1;">
    <div class="uk-card-body uk-padding-small uk-padding-remove-bottom">
        <h2  class="uk-margin-remove-bottom">Beszélgetések</h2>
    </div>
    <div class="uk-card-footer uk-padding-small uk-padding-remove-top uk-padding-remove-bottom" id="search-form">       
        <%= form_with url: url_for(action: 'view', controller: 'conversations'), local: true, method: :get, id: 'search_form', class: "uk-padding-small uk-padding-remove-left uk-padding-remove-right" do |form| %>
            <% unless @mobile.nil? %>
			  	<%= hidden_field_tag(:mobile, "middle")%>
			<% end %>
                <%= form.text_field :q, placeholder: "Keresés a felhasználók között" %>
            <%= hidden_field_tag :selected_user_id, ''  %> 
        <% end %>							
                            
    </div>
</div>
<div id="contacts-list">
    <%= render partial: "contacts_list" %>
</div>