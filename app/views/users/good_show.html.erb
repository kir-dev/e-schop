<div class="uk-child-width-1-2 uk-flex-center" uk-grid>
  <div>
    <div class="" uk-grid>
      <div class="uk-width-1-3@m">
        <%=image_tag get_image(@good)%>
      </div>
      <div class="uk-width-2-3@m">
        <p>
          <strong>Név:</strong>
          <%= @good.name %>
        </p>

        <p>
          <strong>Ár/db:</strong>
          <%= @good.price %> Ft
        </p>

        <p>
          <strong>Darabszám:</strong>
          <% if params[:purchase_id].nil? %>
            <%= @good.number %>
          <% else %>
            <%= Purchase.find(params[:purchase_id]).number %>
          <% end %>
        </p>

        <% if !params[:purchase_id].nil? %>
          <p>
            <strong>Összesen fizetendő:</strong>
            <%= Purchase.find(params[:purchase_id]).number * @good.price %> Ft
          </p>
        <% end %>

        <p>
          <% if @good.seller_id != current_user.id %>
            <strong>Eladó:</strong>
            <% seller = User.find_by_id(@good.seller_id) %>
            <%= link_to seller.username, { action: 'show_other_user',
                                           id: seller.id, good_id: @good.id }  %>
          <% elsif @good.seller_id == current_user.id && !params[:purchase_id].nil? %>
            <strong>Vevő:</strong>
            <% purchase = Purchase.find(params[:purchase_id]) %>
            <% buyer = User.find_by_id(purchase.buyer_id) %>
            <%= link_to buyer.username, { action: 'show_other_user',
                                           id: buyer.id, good_id: @good.id }  %>
          <% end %>
        </p>

        <%=render partial:"goods/tags", object:@good.tags%>

        <p>
          <strong>Leírás:</strong>
          <%= @good.description %>
        </p>

        <% if @good.seller_id == current_user.id && params[:purchase_id].nil? %>
          <p><%= link_to 'Törlés', {action: 'delete_num', controller: 'goods', id: @good.id}%></p>
          <p><%= link_to 'Szerkesztés', {action: 'edit', controller: 'goods', id: @good.id}%></p>
        <% end %>
        <% if !params[:purchase_id].nil? %>
          <% purchase = Purchase.find(params[:purchase_id]) %>
          <% if purchase.buyer_id == current_user.id %>           
            <p>
              <% uzenet = "Tényleg törölni akarod a rendelést?"%>
              <%=link_to "Eldobás", {action: 'back_from_cart', controller: 'purchases', id: purchase.id}, data: {confirm: uzenet} %>
            </p>
          <% else %> 
            <p>
              <% uzenet = "Valóban kifezette " + User.find_by_id(purchase.buyer_id).username + " a vásárlást?"%>
              <%=link_to "Kifizetve", { action: 'delete', controller: 'purchases', id: purchase.id }, data: {confirm: uzenet} %>
            </p>
          <% end %>
        <% end %>
      </div>
    </div>   
  </div>
</div>
